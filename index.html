<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Scanner QR – Mariage Alexis & July</title>

<!-- Scanner QR -->
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

<!-- Style externe -->
<link rel="stylesheet" href="style.css">

</head>
<body>

<!-- BANNIÈRE (mets ta photo dans style.css) -->
<div class="banner"></div>

<h2>Scanner QR – Mariage Alexis & July</h2>
<p class="subtitle">Accès protocole – Vérification de l'invité</p>

<div class="scanner-card">
  <div id="reader" style="width:300px; margin:auto;"></div>
</div>

<div id="result"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxnPRc6xJ1cme6EoVM55iAq_4Y_Vo6OaLplNvgtvbg2mnCEOYkVM4EPej_lHGD_lAH-/exec";

function onScanSuccess(decodedText) {
  fetch(API_URL + "?id=" + encodeURIComponent(decodedText))
    .then(res => res.json())
    .then(data => {
      if (data.error) {
        document.getElementById("result").innerHTML =
          "<div class='card error'>QR non reconnu ❌</div>";
      } else {
        document.getElementById("result").innerHTML =
          "<div class='card'>" +
          "<h3>Invité : " + data.name + "</h3>" +
          "<p><b>Numéro de Table :</b> " + data.tableNumber + "</p>" +
          "<p><b>Nom de la Table :</b> " + data.tableName + "</p>" +
          "</div>";
      }
    })
    .catch(err => {
      document.getElementById("result").innerHTML =
        "<div class='card error'>Erreur de communication ⚠️</div>";
    });
}

var html5QrcodeScanner = new Html5QrcodeScanner(
  "reader", { fps: 10, qrbox: 250 });
html5QrcodeScanner.render(onScanSuccess);
</script>

</body>
</html>
